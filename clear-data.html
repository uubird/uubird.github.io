<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>清除留言数据</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f8f9fa;
        }
        .card {
            max-width: 500px;
            width: 100%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="card p-5">
        <h2 class="text-center mb-4">清除留言数据</h2>
        <p class="text-center text-muted mb-5">点击下方按钮将清除所有本地存储的留言数据</p>
        <button id="clearBtn" class="btn btn-danger w-100 py-3">
            清除所有留言数据
        </button>
        <div id="status" class="mt-4 text-center"></div>
    </div>

    <!-- 引入清除脚本 -->
    <script src="clear-messages.js"></script>
    <script>
        document.getElementById('clearBtn').addEventListener('click', function() {
            if (confirm('确定要彻底清除所有留言数据吗？此操作将：\n1. 清除所有存储的留言\n2. 防止三条问题留言重新生成\n3. 确保留言板显示为空\n\n此操作不可恢复。')) {
                // 调用增强版清除函数
                const success = clearAllMessageData();
                
                const status = document.getElementById('status');
                if (success) {
                    status.className = 'mt-4 text-center text-success font-bold';
                    status.innerHTML = `
                        <div class="mb-2"><i class="fa fa-check-circle text-xl"></i> 数据清除成功！</div>
                        <ul class="text-left text-sm max-w-md mx-auto">
                            <li>✅ 所有留言数据已清除</li>
                            <li>✅ 已设置防护标记防止默认留言重新生成</li>
                            <li>✅ 三条问题留言将不再出现</li>
                        </ul>
                        <div class="mt-3">页面将在5秒后跳转...</div>
                    `;
                    
                    // 添加图标库
                    if (!document.getElementById('fontAwesome')) {
                        const link = document.createElement('link');
                        link.id = 'fontAwesome';
                        link.rel = 'stylesheet';
                        link.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
                        document.head.appendChild(link);
                    }
                    
                    setTimeout(() => {
                        window.location.href = 'robust-message-board.html';
                    }, 5000);
                } else {
                    status.className = 'mt-4 text-center text-danger';
                    status.textContent = '清除失败：浏览器不支持localStorage。请手动清除浏览器缓存和本地存储。';
                }
            }
        });
    </script>
</body>
</html>
